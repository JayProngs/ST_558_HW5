[
  {
    "objectID": "ST_558_HW5.html",
    "href": "ST_558_HW5.html",
    "title": "ST_558_HW5",
    "section": "",
    "text": "d1 &lt;- read.csv(\"student-mat.csv\", sep = \";\", header = TRUE)\nd2 &lt;- read.csv(\"student-por.csv\", sep = \";\", header = TRUE)\n\nd3=merge(d1,d2,by=c(\"school\",\"sex\",\"age\",\"address\",\"famsize\",\"Pstatus\",\"Medu\",\"Fedu\",\"Mjob\",\"Fjob\",\"reason\",\"nursery\",\"internet\"))\nprint(nrow(d3))\n\n[1] 382\n\n\n\n\n\n\nlibrary(readr)\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nd1 &lt;- read_delim(\"student-mat.csv\",delim = \";\")\n\nRows: 395 Columns: 33\n\n\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \";\"\nchr (17): school, sex, address, famsize, Pstatus, Mjob, Fjob, reason, guardi...\ndbl (16): age, Medu, Fedu, traveltime, studytime, failures, famrel, freetime...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nd2 &lt;- read_delim(\"student-por.csv\",delim = \";\")\n\nRows: 649 Columns: 33\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \";\"\nchr (17): school, sex, address, famsize, Pstatus, Mjob, Fjob, reason, guardi...\ndbl (16): age, Medu, Fedu, traveltime, studytime, failures, famrel, freetime...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nstudent_combined &lt;- inner_join(d1, d2, by = c(\"school\", \"sex\", \"age\", \"address\", \n                                                                \"famsize\", \"Pstatus\", \"Medu\", \"Fedu\", \n                                                                \"Mjob\", \"Fjob\", \"reason\", \"nursery\", \n                                                                \"internet\"))\n\nWarning in inner_join(d1, d2, by = c(\"school\", \"sex\", \"age\", \"address\", : Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 79 of `x` matches multiple rows in `y`.\nℹ Row 79 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.\n\n\nThe warning message suggests that there are multiple matching rows in both datasets (student-mat and student-por). This happens when combination of values in join are not unique. In this case we have some rows that don’t have unique values for school, sex, age, etc., combinations in both datasets.\n\n\n\n\nstudent_combined_final &lt;- inner_join(d1, d2, by = c(\"school\", \"sex\", \"age\", \"address\", \n                                                                      \"famsize\", \"Pstatus\", \"Medu\", \"Fedu\", \n                                                                      \"Mjob\", \"Fjob\", \"reason\", \"guardian\", \n                                                                      \"traveltime\", \"studytime\", \"failures\", \n                                                                      \"schoolsup\", \"famsup\", \"activities\", \n                                                                      \"nursery\", \"higher\", \"internet\", \n                                                                      \"romantic\", \"famrel\", \"freetime\", \n                                                                      \"goout\", \"Dalc\", \"Walc\", \"health\", \"absences\"))\nstudent_combined_final\n\n# A tibble: 85 × 37\n   school sex     age address famsize Pstatus  Medu  Fedu Mjob     Fjob   reason\n   &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt; \n 1 GP     M        16 U       LE3     T           2     2 other    other  home  \n 2 GP     M        15 U       LE3     A           3     2 services other  home  \n 3 GP     M        15 U       GT3     T           3     4 other    other  home  \n 4 GP     M        15 U       GT3     A           2     2 other    other  home  \n 5 GP     M        15 U       GT3     T           4     3 teacher  other  reput…\n 6 GP     M        15 U       GT3     T           4     4 health   health other \n 7 GP     F        15 R       GT3     T           2     4 services health course\n 8 GP     M        15 U       GT3     T           4     4 health   servi… home  \n 9 GP     M        15 R       GT3     T           4     3 teacher  at_ho… course\n10 GP     M        15 U       LE3     T           3     3 other    other  course\n# ℹ 75 more rows\n# ℹ 26 more variables: guardian &lt;chr&gt;, traveltime &lt;dbl&gt;, studytime &lt;dbl&gt;,\n#   failures &lt;dbl&gt;, schoolsup &lt;chr&gt;, famsup &lt;chr&gt;, paid.x &lt;chr&gt;,\n#   activities &lt;chr&gt;, nursery &lt;chr&gt;, higher &lt;chr&gt;, internet &lt;chr&gt;,\n#   romantic &lt;chr&gt;, famrel &lt;dbl&gt;, freetime &lt;dbl&gt;, goout &lt;dbl&gt;, Dalc &lt;dbl&gt;,\n#   Walc &lt;dbl&gt;, health &lt;dbl&gt;, absences &lt;dbl&gt;, G1.x &lt;dbl&gt;, G2.x &lt;dbl&gt;,\n#   G3.x &lt;dbl&gt;, paid.y &lt;chr&gt;, G1.y &lt;dbl&gt;, G2.y &lt;dbl&gt;, G3.y &lt;dbl&gt;\n\n\n\n\n\n\nd1 &lt;- d1 |&gt;\n  mutate(school = as.factor(school),\n         sex = as.factor(sex),\n         address = as.factor(address),\n         famsize = as.factor(famsize))\n\nd2 &lt;- d2 |&gt;\n  mutate(school = as.factor(school),\n         sex = as.factor(sex),\n         address = as.factor(address),\n         famsize = as.factor(famsize))\n\nstudent_combined_final &lt;- student_combined_final |&gt;\n  mutate(school = as.factor(school),\n         sex = as.factor(sex),\n         address = as.factor(address),\n         famsize = as.factor(famsize))"
  },
  {
    "objectID": "ST_558_HW5.html#task-1-read-in-the-data-and-modify",
    "href": "ST_558_HW5.html#task-1-read-in-the-data-and-modify",
    "title": "ST_558_HW5",
    "section": "",
    "text": "d1 &lt;- read.csv(\"student-mat.csv\", sep = \";\", header = TRUE)\nd2 &lt;- read.csv(\"student-por.csv\", sep = \";\", header = TRUE)\n\nd3=merge(d1,d2,by=c(\"school\",\"sex\",\"age\",\"address\",\"famsize\",\"Pstatus\",\"Medu\",\"Fedu\",\"Mjob\",\"Fjob\",\"reason\",\"nursery\",\"internet\"))\nprint(nrow(d3))\n\n[1] 382\n\n\n\n\n\n\nlibrary(readr)\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nd1 &lt;- read_delim(\"student-mat.csv\",delim = \";\")\n\nRows: 395 Columns: 33\n\n\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \";\"\nchr (17): school, sex, address, famsize, Pstatus, Mjob, Fjob, reason, guardi...\ndbl (16): age, Medu, Fedu, traveltime, studytime, failures, famrel, freetime...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nd2 &lt;- read_delim(\"student-por.csv\",delim = \";\")\n\nRows: 649 Columns: 33\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \";\"\nchr (17): school, sex, address, famsize, Pstatus, Mjob, Fjob, reason, guardi...\ndbl (16): age, Medu, Fedu, traveltime, studytime, failures, famrel, freetime...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nstudent_combined &lt;- inner_join(d1, d2, by = c(\"school\", \"sex\", \"age\", \"address\", \n                                                                \"famsize\", \"Pstatus\", \"Medu\", \"Fedu\", \n                                                                \"Mjob\", \"Fjob\", \"reason\", \"nursery\", \n                                                                \"internet\"))\n\nWarning in inner_join(d1, d2, by = c(\"school\", \"sex\", \"age\", \"address\", : Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 79 of `x` matches multiple rows in `y`.\nℹ Row 79 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.\n\n\nThe warning message suggests that there are multiple matching rows in both datasets (student-mat and student-por). This happens when combination of values in join are not unique. In this case we have some rows that don’t have unique values for school, sex, age, etc., combinations in both datasets.\n\n\n\n\nstudent_combined_final &lt;- inner_join(d1, d2, by = c(\"school\", \"sex\", \"age\", \"address\", \n                                                                      \"famsize\", \"Pstatus\", \"Medu\", \"Fedu\", \n                                                                      \"Mjob\", \"Fjob\", \"reason\", \"guardian\", \n                                                                      \"traveltime\", \"studytime\", \"failures\", \n                                                                      \"schoolsup\", \"famsup\", \"activities\", \n                                                                      \"nursery\", \"higher\", \"internet\", \n                                                                      \"romantic\", \"famrel\", \"freetime\", \n                                                                      \"goout\", \"Dalc\", \"Walc\", \"health\", \"absences\"))\nstudent_combined_final\n\n# A tibble: 85 × 37\n   school sex     age address famsize Pstatus  Medu  Fedu Mjob     Fjob   reason\n   &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt; \n 1 GP     M        16 U       LE3     T           2     2 other    other  home  \n 2 GP     M        15 U       LE3     A           3     2 services other  home  \n 3 GP     M        15 U       GT3     T           3     4 other    other  home  \n 4 GP     M        15 U       GT3     A           2     2 other    other  home  \n 5 GP     M        15 U       GT3     T           4     3 teacher  other  reput…\n 6 GP     M        15 U       GT3     T           4     4 health   health other \n 7 GP     F        15 R       GT3     T           2     4 services health course\n 8 GP     M        15 U       GT3     T           4     4 health   servi… home  \n 9 GP     M        15 R       GT3     T           4     3 teacher  at_ho… course\n10 GP     M        15 U       LE3     T           3     3 other    other  course\n# ℹ 75 more rows\n# ℹ 26 more variables: guardian &lt;chr&gt;, traveltime &lt;dbl&gt;, studytime &lt;dbl&gt;,\n#   failures &lt;dbl&gt;, schoolsup &lt;chr&gt;, famsup &lt;chr&gt;, paid.x &lt;chr&gt;,\n#   activities &lt;chr&gt;, nursery &lt;chr&gt;, higher &lt;chr&gt;, internet &lt;chr&gt;,\n#   romantic &lt;chr&gt;, famrel &lt;dbl&gt;, freetime &lt;dbl&gt;, goout &lt;dbl&gt;, Dalc &lt;dbl&gt;,\n#   Walc &lt;dbl&gt;, health &lt;dbl&gt;, absences &lt;dbl&gt;, G1.x &lt;dbl&gt;, G2.x &lt;dbl&gt;,\n#   G3.x &lt;dbl&gt;, paid.y &lt;chr&gt;, G1.y &lt;dbl&gt;, G2.y &lt;dbl&gt;, G3.y &lt;dbl&gt;\n\n\n\n\n\n\nd1 &lt;- d1 |&gt;\n  mutate(school = as.factor(school),\n         sex = as.factor(sex),\n         address = as.factor(address),\n         famsize = as.factor(famsize))\n\nd2 &lt;- d2 |&gt;\n  mutate(school = as.factor(school),\n         sex = as.factor(sex),\n         address = as.factor(address),\n         famsize = as.factor(famsize))\n\nstudent_combined_final &lt;- student_combined_final |&gt;\n  mutate(school = as.factor(school),\n         sex = as.factor(sex),\n         address = as.factor(address),\n         famsize = as.factor(famsize))"
  },
  {
    "objectID": "ST_558_HW5.html#task-2-summarize-the-data",
    "href": "ST_558_HW5.html#task-2-summarize-the-data",
    "title": "ST_558_HW5",
    "section": "Task 2: Summarize the Data",
    "text": "Task 2: Summarize the Data\n\nChecking missing values in data\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nglimpse(student_combined)\n\nRows: 382\nColumns: 53\n$ school       &lt;chr&gt; \"GP\", \"GP\", \"GP\", \"GP\", \"GP\", \"GP\", \"GP\", \"GP\", \"GP\", \"GP…\n$ sex          &lt;chr&gt; \"F\", \"F\", \"F\", \"F\", \"F\", \"M\", \"M\", \"F\", \"M\", \"M\", \"F\", \"F…\n$ age          &lt;dbl&gt; 18, 17, 15, 15, 16, 16, 16, 17, 15, 15, 15, 15, 15, 15, 1…\n$ address      &lt;chr&gt; \"U\", \"U\", \"U\", \"U\", \"U\", \"U\", \"U\", \"U\", \"U\", \"U\", \"U\", \"U…\n$ famsize      &lt;chr&gt; \"GT3\", \"GT3\", \"LE3\", \"GT3\", \"GT3\", \"LE3\", \"LE3\", \"GT3\", \"…\n$ Pstatus      &lt;chr&gt; \"A\", \"T\", \"T\", \"T\", \"T\", \"T\", \"T\", \"A\", \"A\", \"T\", \"T\", \"T…\n$ Medu         &lt;dbl&gt; 4, 1, 1, 4, 3, 4, 2, 4, 3, 3, 4, 2, 4, 4, 2, 4, 4, 3, 3, …\n$ Fedu         &lt;dbl&gt; 4, 1, 1, 2, 3, 3, 2, 4, 2, 4, 4, 1, 4, 3, 2, 4, 4, 3, 2, …\n$ Mjob         &lt;chr&gt; \"at_home\", \"at_home\", \"at_home\", \"health\", \"other\", \"serv…\n$ Fjob         &lt;chr&gt; \"teacher\", \"other\", \"other\", \"services\", \"other\", \"other\"…\n$ reason       &lt;chr&gt; \"course\", \"course\", \"other\", \"home\", \"home\", \"reputation\"…\n$ guardian.x   &lt;chr&gt; \"mother\", \"father\", \"mother\", \"mother\", \"father\", \"mother…\n$ traveltime.x &lt;dbl&gt; 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 3, 1, 2, 1, 1, 1, 3, 1, …\n$ studytime.x  &lt;dbl&gt; 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 3, 1, 2, 3, 1, 3, 2, 1, …\n$ failures.x   &lt;dbl&gt; 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, …\n$ schoolsup.x  &lt;chr&gt; \"yes\", \"no\", \"yes\", \"no\", \"no\", \"no\", \"no\", \"yes\", \"no\", …\n$ famsup.x     &lt;chr&gt; \"no\", \"yes\", \"no\", \"yes\", \"yes\", \"yes\", \"no\", \"yes\", \"yes…\n$ paid.x       &lt;chr&gt; \"no\", \"no\", \"yes\", \"yes\", \"yes\", \"yes\", \"no\", \"no\", \"yes\"…\n$ activities.x &lt;chr&gt; \"no\", \"no\", \"no\", \"yes\", \"no\", \"yes\", \"no\", \"no\", \"no\", \"…\n$ nursery      &lt;chr&gt; \"yes\", \"no\", \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"y…\n$ higher.x     &lt;chr&gt; \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"…\n$ internet     &lt;chr&gt; \"no\", \"yes\", \"yes\", \"yes\", \"no\", \"yes\", \"yes\", \"no\", \"yes…\n$ romantic.x   &lt;chr&gt; \"no\", \"no\", \"no\", \"yes\", \"no\", \"no\", \"no\", \"no\", \"no\", \"n…\n$ famrel.x     &lt;dbl&gt; 4, 5, 4, 3, 4, 5, 4, 4, 4, 5, 3, 5, 4, 5, 4, 4, 3, 5, 5, …\n$ freetime.x   &lt;dbl&gt; 3, 3, 3, 2, 3, 4, 4, 1, 2, 5, 3, 2, 3, 4, 5, 4, 2, 3, 5, …\n$ goout.x      &lt;dbl&gt; 4, 3, 2, 2, 2, 2, 4, 4, 2, 1, 3, 2, 3, 3, 2, 4, 3, 2, 5, …\n$ Dalc.x       &lt;dbl&gt; 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, …\n$ Walc.x       &lt;dbl&gt; 1, 1, 3, 1, 2, 2, 1, 1, 1, 1, 2, 1, 3, 2, 1, 2, 2, 1, 4, …\n$ health.x     &lt;dbl&gt; 3, 3, 3, 5, 5, 5, 3, 1, 1, 5, 2, 4, 5, 3, 3, 2, 2, 4, 5, …\n$ absences.x   &lt;dbl&gt; 6, 4, 10, 2, 4, 10, 0, 6, 0, 0, 0, 4, 2, 2, 0, 4, 6, 4, 1…\n$ G1.x         &lt;dbl&gt; 5, 5, 7, 15, 6, 15, 12, 6, 16, 14, 10, 10, 14, 10, 14, 14…\n$ G2.x         &lt;dbl&gt; 6, 5, 8, 14, 10, 15, 12, 5, 18, 15, 8, 12, 14, 10, 16, 14…\n$ G3.x         &lt;dbl&gt; 6, 6, 10, 15, 10, 15, 11, 6, 19, 15, 9, 12, 14, 11, 16, 1…\n$ guardian.y   &lt;chr&gt; \"mother\", \"father\", \"mother\", \"mother\", \"father\", \"mother…\n$ traveltime.y &lt;dbl&gt; 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 3, 1, 2, 1, 1, 1, 3, 1, …\n$ studytime.y  &lt;dbl&gt; 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 3, 1, 2, 3, 1, 3, 2, 1, …\n$ failures.y   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, …\n$ schoolsup.y  &lt;chr&gt; \"yes\", \"no\", \"yes\", \"no\", \"no\", \"no\", \"no\", \"yes\", \"no\", …\n$ famsup.y     &lt;chr&gt; \"no\", \"yes\", \"no\", \"yes\", \"yes\", \"yes\", \"no\", \"yes\", \"yes…\n$ paid.y       &lt;chr&gt; \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no…\n$ activities.y &lt;chr&gt; \"no\", \"no\", \"no\", \"yes\", \"no\", \"yes\", \"no\", \"no\", \"no\", \"…\n$ higher.y     &lt;chr&gt; \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"…\n$ romantic.y   &lt;chr&gt; \"no\", \"no\", \"no\", \"yes\", \"no\", \"no\", \"no\", \"no\", \"no\", \"n…\n$ famrel.y     &lt;dbl&gt; 4, 5, 4, 3, 4, 5, 4, 4, 4, 5, 3, 5, 4, 5, 4, 4, 3, 5, 5, …\n$ freetime.y   &lt;dbl&gt; 3, 3, 3, 2, 3, 4, 4, 1, 2, 5, 3, 2, 3, 4, 5, 4, 2, 3, 5, …\n$ goout.y      &lt;dbl&gt; 4, 3, 2, 2, 2, 2, 4, 4, 2, 1, 3, 2, 3, 3, 2, 4, 3, 2, 5, …\n$ Dalc.y       &lt;dbl&gt; 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, …\n$ Walc.y       &lt;dbl&gt; 1, 1, 3, 1, 2, 2, 1, 1, 1, 1, 2, 1, 3, 2, 1, 2, 2, 1, 4, …\n$ health.y     &lt;dbl&gt; 3, 3, 3, 5, 5, 5, 3, 1, 1, 5, 2, 4, 5, 3, 3, 2, 2, 4, 5, …\n$ absences.y   &lt;dbl&gt; 4, 2, 6, 0, 0, 6, 0, 2, 0, 0, 2, 0, 0, 0, 0, 6, 10, 2, 2,…\n$ G1.y         &lt;dbl&gt; 0, 9, 12, 14, 11, 12, 13, 10, 15, 12, 14, 10, 12, 12, 14,…\n$ G2.y         &lt;dbl&gt; 11, 11, 13, 14, 13, 12, 12, 13, 16, 12, 14, 12, 13, 12, 1…\n$ G3.y         &lt;dbl&gt; 11, 11, 12, 14, 13, 13, 13, 13, 17, 13, 14, 13, 12, 13, 1…\n\nmissing_summary &lt;- student_combined |&gt;\n  summarize(across(everything(), ~ sum(is.na(.)))) |&gt;\n  pivot_longer(cols = everything(), names_to = \"Variable\", values_to = \"Missing_Count\") ## |&gt;\n  # filter(Missing_Count &gt; 0)\n\n\nprint(missing_summary)\n\n# A tibble: 53 × 2\n   Variable Missing_Count\n   &lt;chr&gt;            &lt;int&gt;\n 1 school               0\n 2 sex                  0\n 3 age                  0\n 4 address              0\n 5 famsize              0\n 6 Pstatus              0\n 7 Medu                 0\n 8 Fedu                 0\n 9 Mjob                 0\n10 Fjob                 0\n# ℹ 43 more rows\n\n\nNo missing values in data. Based on filter(Missing_Count &gt; 0) subsetting we can check if there is missing data.\n\n\nCategorical variables\n\nCreating One way, two way and three-way contingency table with school, sex and address.\n\ntable_one_way &lt;- table(student_combined$school)\nprint(table_one_way)\n\n\n GP  MS \n342  40 \n\n\n342 value in table shows that there are 342 students in Gabriel Pereira school.\n\ntable_two_way &lt;- table(student_combined$school, student_combined$sex)\nprint(table_two_way)\n\n    \n       F   M\n  GP 175 167\n  MS  23  17\n\n\nFirst row, 175 & 167, in above table shows that there are 175 female students and 167 male students in Gabriel Pereira school.\n\ntable_three_way &lt;- table(student_combined$school, student_combined$sex, student_combined$address)\nprint(table_three_way)\n\n, ,  = R\n\n    \n       F   M\n  GP  29  30\n  MS  12  10\n\n, ,  = U\n\n    \n       F   M\n  GP 146 137\n  MS  11   7\n\n\nFirst row in first list, GP 29 30, shows that there are 29 Female and 30 male students in Gabriel Pereira school with address type as rural.\n\n\nSubsetting the data as Urban address type and then creating the two-way table\n\nconditional_table_subset &lt;- student_combined |&gt;\n  filter(address == \"U\") |&gt;\n  with(table(school, sex))\n\nprint(conditional_table_subset)\n\n      sex\nschool   F   M\n    GP 146 137\n    MS  11   7\n\n\nNumber of Male and female students in each school with Urban address type.\n\n\nCreating three-way table and then subsetting it as Urban address type\n\nthree_way_table &lt;- table(student_combined$school, student_combined$sex, student_combined$address)\nconditional_table_three_way &lt;- three_way_table[,, \"U\"]\n\nprint(conditional_table_three_way)\n\n    \n       F   M\n  GP 146 137\n  MS  11   7\n\n\n\n\nCreating a two-way contingency table using dplyr, groupby and summarize.\n\ncontingency_table &lt;- student_combined |&gt;\n  group_by(school, sex) |&gt;\n  summarize(count = n(), .groups = \"drop\") |&gt;\n  pivot_wider(names_from = sex, values_from = count)\n\nprint(contingency_table)\n\n# A tibble: 2 × 3\n  school     F     M\n  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;\n1 GP       175   167\n2 MS        23    17\n\n\nThe output shows us number Male and Female students in each school.\n\n\nCreating stacked Bar Graph of School by Sex\n\nggplot(student_combined, aes(x = school, fill = sex)) +\n  geom_bar(position = \"stack\") +\n  labs(x = \"School\", y = \"Count\", fill = \"Sex\", title = \"Stacked Bar Graph of School by Sex\")\n\n\n\n\n\n\n\n\nThe graph shows that GP school has more students than MS. And the graph shows division by Sex.\n\n\nCreating side-by-Side Bar Graph of School by Sex\n\nggplot(student_combined, aes(x = school, fill = sex)) +\n  geom_bar(position = \"dodge\") +\n  labs(x = \"School\", y = \"Count\", fill = \"Sex\", title = \"Side-by-Side Bar Graph of School by Sex\")\n\n\n\n\n\n\n\n\nSame with this graph, it shows that in both school there are more Female students than Male.\n\n\n\nNumeric variables (and across groups)\n\nCalculating Measures of centre (mean) and spread (SD) for age, G3 from the Portuguese dataset, and absences\n\nsummary_stats &lt;- student_combined |&gt;\n  summarize(\n    mean_age = mean(age, na.rm = TRUE),\n    sd_age = sd(age, na.rm = TRUE),\n    mean_G3_por = mean(G3.y, na.rm = TRUE),\n    sd_G3_por = sd(G3.y, na.rm = TRUE),\n    mean_absences = mean(absences.x, na.rm = TRUE),\n    sd_absences = sd(absences.x, na.rm = TRUE)\n  )\n\nprint(summary_stats)\n\n# A tibble: 1 × 6\n  mean_age sd_age mean_G3_por sd_G3_por mean_absences sd_absences\n     &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;       &lt;dbl&gt;\n1     16.6   1.17        12.5      2.95          5.32        7.63\n\n\nLow SD of age shows that Students are mostly around mean age i.e., 16.5. But in case of absenses we can see high number of variability.\n\n\nCalculating Measures of centre (mean) and spread (SD) for age, G3 from the Portuguese dataset, and absences after subsetting on Filter variable\n\nsummary_stats &lt;- student_combined |&gt;\n  filter(internet == \"yes\") |&gt;\n  summarize(\n    mean_age = mean(age, na.rm = TRUE),\n    sd_age = sd(age, na.rm = TRUE),\n    mean_G3_por = mean(G3.y, na.rm = TRUE),\n    sd_G3_por = sd(G3.y, na.rm = TRUE),\n    mean_absences = mean(absences.x, na.rm = TRUE),\n    sd_absences = sd(absences.x, na.rm = TRUE)\n  )\n\nprint(summary_stats)\n\n# A tibble: 1 × 6\n  mean_age sd_age mean_G3_por sd_G3_por mean_absences sd_absences\n     &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;       &lt;dbl&gt;\n1     16.5   1.17        12.6      2.84          5.63        8.08\n\nsummary_stats &lt;- student_combined |&gt;\n  filter(internet == \"no\") |&gt;\n  summarize(\n    mean_age = mean(age, na.rm = TRUE),\n    sd_age = sd(age, na.rm = TRUE),\n    mean_G3_por = mean(G3.y, na.rm = TRUE),\n    sd_G3_por = sd(G3.y, na.rm = TRUE),\n    mean_absences = mean(absences.x, na.rm = TRUE),\n    sd_absences = sd(absences.x, na.rm = TRUE)\n  )\n\nprint(summary_stats)\n\n# A tibble: 1 × 6\n  mean_age sd_age mean_G3_por sd_G3_por mean_absences sd_absences\n     &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;       &lt;dbl&gt;\n1     16.8   1.19        11.9      3.42          3.60        3.92\n\n\nAs from above values we can see that mean and SD value for absense where Internet variable had “Yes” value is more than the other one.\n\n\nCalculating Measures of centre (mean) and spread (SD) for age, G3 from the Portuguese dataset, and absences variables across Sex\n\nsummary_stats &lt;- student_combined |&gt;\n  group_by(sex) |&gt;\n  summarize(\n    mean_age = mean(age, na.rm = TRUE),\n    sd_age = sd(age, na.rm = TRUE),\n    mean_G3_por = mean(G3.y, na.rm = TRUE),\n    sd_G3_por = sd(G3.y, na.rm = TRUE),\n    mean_absences = mean(absences.x, na.rm = TRUE),\n    sd_absences = sd(absences.x, na.rm = TRUE)\n  )\n\nprint(summary_stats)\n\n# A tibble: 2 × 7\n  sex   mean_age sd_age mean_G3_por sd_G3_por mean_absences sd_absences\n  &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;       &lt;dbl&gt;\n1 F         16.6   1.10        13.1      2.50          5.79        9.16\n2 M         16.6   1.25        11.9      3.26          4.82        5.50\n\n\nWe can see that mean age for both Male and female are same but Females have more average score in grade. This could suggest female students performs better or more consistent than Male as Male students have more SD.\n\n\nCalculating Measures of centre (mean) and spread (SD) for age, G3 from the Portuguese dataset, and absences variables across Sex and School\n\nsummary_stats &lt;- student_combined |&gt;\n  group_by(school, sex) |&gt;\n  summarize(\n    mean_age = mean(age, na.rm = TRUE),\n    sd_age = sd(age, na.rm = TRUE),\n    mean_G3_por = mean(G3.y, na.rm = TRUE),\n    sd_G3_por = sd(G3.y, na.rm = TRUE),\n    mean_absences = mean(absences.x, na.rm = TRUE),\n    sd_absences = sd(absences.x, na.rm = TRUE)\n  )\n\n`summarise()` has grouped output by 'school'. You can override using the\n`.groups` argument.\n\nprint(summary_stats)\n\n# A tibble: 4 × 8\n# Groups:   school [2]\n  school sex   mean_age sd_age mean_G3_por sd_G3_por mean_absences sd_absences\n  &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;       &lt;dbl&gt;\n1 GP     F         16.5  1.07        13.3       2.19          6.15        9.53\n2 GP     M         16.4  1.21        12.1       2.89          4.86        5.65\n3 MS     F         17.7  0.559       11.8       3.97          3.04        4.90\n4 MS     M         17.9  0.659        9.82      5.45          4.35        3.69\n\n\nFrom above summary we can see that students at MS are older than GP. And male students at MS have significantly lower Grades than all other groups. And despite having higher grades, Female students at GP have higher number of absenses.\n\n\nCorrelation matrix between all of the numeric variables\n\nnumeric_vars &lt;- student_combined |&gt; select(age, absences.x, absences.y, G1.x, G2.x, G3.x, G1.y, G2.y, G3.y)\ncor_matrix &lt;- cor(numeric_vars, use = \"complete.obs\")\nprint(cor_matrix)\n\n                   age  absences.x  absences.y        G1.x       G2.x\nage         1.00000000  0.12597150  0.08630293 -0.11748570 -0.1753698\nabsences.x  0.12597150  1.00000000  0.49659477 -0.05560837 -0.0418404\nabsences.y  0.08630293  0.49659477  1.00000000 -0.14238314 -0.1676497\nG1.x       -0.11748570 -0.05560837 -0.14238314  1.00000000  0.8603952\nG2.x       -0.17536977 -0.04184040 -0.16764967  0.86039517  1.0000000\nG3.x       -0.19458854  0.02898725 -0.15803320  0.80512870  0.9030267\nG1.y       -0.10954866 -0.06472524 -0.15798132  0.56800812  0.5259444\nG2.y       -0.04201003 -0.10710566 -0.20031888  0.58882910  0.5696564\nG3.y       -0.06797748 -0.09429734 -0.14486094  0.55084372  0.5074996\n                  G3.x        G1.y        G2.y        G3.y\nage        -0.19458854 -0.10954866 -0.04201003 -0.06797748\nabsences.x  0.02898725 -0.06472524 -0.10710566 -0.09429734\nabsences.y -0.15803320 -0.15798132 -0.20031888 -0.14486094\nG1.x        0.80512870  0.56800812  0.58882910  0.55084372\nG2.x        0.90302671  0.52594436  0.56965643  0.50749963\nG3.x        1.00000000  0.49530474  0.53555152  0.48034936\nG1.y        0.49530474  1.00000000  0.88790615  0.81904820\nG2.y        0.53555152  0.88790615  1.00000000  0.89244365\nG3.y        0.48034936  0.81904820  0.89244365  1.00000000\n\n\n\n\nHistogram and density plot for age by school\n\nggplot(student_combined, aes(x = age, fill = school)) +\n  geom_histogram(alpha = 0.6, position = \"identity\", binwidth = 1) +\n  labs(x = \"Age\", title = \"Histogram of Age by School\")\n\n\n\n\n\n\n\nggplot(student_combined, aes(x = age, color = school)) +\n  geom_density() +\n  labs(x = \"Age\", title = \"Density Plot of Age by School\")\n\n\n\n\n\n\n\n\nHistogram shows us that there are older students in MS school and significant different in student population between GP and MS. Density plot shows sharp peak at 18 for MS might indicate that this school is mostly for students with 18 years. And GP school have variable age spread which would consist of students with varied age.\n\n\nHistogram and density plot for absences by school\n\nggplot(student_combined, aes(x = absences.x, fill = school)) +\n  geom_histogram(alpha = 0.6, position = \"identity\", binwidth = 1) +\n  labs(x = \"Absences\", title = \"Histogram of Absences by School\")\n\n\n\n\n\n\n\nggplot(student_combined, aes(x = absences.x, color = school)) +\n  geom_density() +\n  labs(x = \"Absences\", title = \"Density Plot of Absences by School\")\n\n\n\n\n\n\n\n\nHistogram shows us that there are taller bars near zero which shows absences near zero. Also we can see outlier of students which higher absences in GP. Density plot shows similar picture, so regular attendance in both school is observed.\n\n\nBoxplot for age by sex\n\nggplot(student_combined, aes(x = sex, y = age, fill = sex)) +\n  geom_boxplot() +\n  labs(x = \"Sex\", y = \"Age\", title = \"Boxplot of Age by Sex\")\n\n\n\n\n\n\n\n\nMedian Age of Male students is higher than Female. Also spread of age in Male students is more, which results in more variable age. Also Male students has older age students are outliers.\n\n\nBoxplot for absences by sex\n\nggplot(student_combined, aes(x = sex, y = absences.x, fill = sex)) +\n  geom_boxplot() +\n  labs(x = \"Sex\", y = \"Absences\", title = \"Boxplot of Absences by Sex\")\n\n\n\n\n\n\n\n\nPresence of outliers in both Male and Female shows absences in school. The spread of absense is more in Male than Female students. The median value of absence is similar in both Male and Female which would mean it is not affected by Gender Variable.\n\n\nScatterplot with jitter for G3 vs G1, colored by school\n\nggplot(student_combined, aes(x = G1.x, y = G3.x, color = school)) +\n  geom_jitter(width = 0.2, height = 0.2) +\n  labs(x = \"G1\", y = \"G3\", color = \"School\", title = \"Scatterplot of G3 vs G1 Colored by School\")\n\n\n\n\n\n\n\n\n\n\nScatterplot with jitter for G3 vs G2, colored by school\n\nggplot(student_combined, aes(x = G2.x, y = G3.x, color = school)) +\n  geom_jitter(width = 0.2, height = 0.2) +\n  labs(x = \"G2\", y = \"G3\", color = \"School\", title = \"Scatterplot of G3 vs G2 Colored by School\")\n\n\n\n\n\n\n\n\nBoth of the scatter plots show string correlation, which means Final Grades is closely similar to performance in G1 and G2. And the overlap between two schools shows that there is not much difference in grades of two school.\n\n\nFaceted Scatterplot of G3 vs G1 by Address\n\nggplot(student_combined, aes(x = G1.x, y = G3.x)) +\n  geom_point(aes(color = school)) +\n  facet_wrap(~address) +\n  labs(x = \"G1\", y = \"G3\", title = \"Faceted Scatterplot of G3 vs G1 by Address\")\n\n\n\n\n\n\n\n\n\n\nFaceted Scatterplot of G3 vs G2 by Address\n\nggplot(student_combined, aes(x = G2.x, y = G3.x)) +\n  geom_point(aes(color = school)) +\n  facet_wrap(~address) +\n  labs(x = \"G2\", y = \"G3\", title = \"Faceted Scatterplot of G3 vs G2 by Address\")\n\n\n\n\n\n\n\n\nThe plot shows that Urban students performs slightly better than Rural students. And both plots are similar in pattern. Although there are slightly more data points in Urban area.\n\n\nScatterplot with faceting by two categorical variables (school and sex) for G1 and G3\n\nggplot(student_combined, aes(x = G1.x, y = G3.x, color = school)) +\n  geom_jitter(width = 0.2, height = 0.2) +\n  facet_grid(school ~ sex) +\n  labs(x = \"G1 (Math First Period Grade)\", \n       y = \"G3 (Math Final Grade)\", \n       title = \"Scatterplot of G3 vs G1 Faceted by School and Sex\", \n       color = \"School\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\nScatterplot with faceting by two categorical variables (school and sex) for G2 and G3\n\nggplot(student_combined, aes(x = G2.x, y = G3.x, color = school)) +\n  geom_jitter(width = 0.2, height = 0.2) +\n  facet_grid(school ~ sex) +  # Facet by school and sex\n  labs(x = \"G2 (Math Second Period Grade)\", \n       y = \"G3 (Math Final Grade)\", \n       title = \"Scatterplot of G3 vs G2 Faceted by School and Sex\", \n       color = \"School\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nLarge number of data points in GP school shows that data might be more skewed towards it in both genders. Also even though there are less students in MS, it shows more consistent grades than GP. Gender wise performance in GP school is almost uniform and similar for Male and Female students."
  }
]